# åœ°å—ç³»ç»Ÿå¿«é€Ÿå¼€å§‹æŒ‡å—

> **ç‰ˆæœ¬**: v1.0
> **æ›´æ–°æ—¥æœŸ**: 2026-01-19

---

## ðŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ5åˆ†é’Ÿï¼‰

### æ­¥éª¤1ï¼šè¿è¡Œæµ‹è¯•åœºæ™¯

1. **æ‰“å¼€ Godot ç¼–è¾‘å™¨**
   ```bash
   open /Applications/Godot_mono.app
   ```

2. **æ‰“å¼€é¡¹ç›®**
   - æ–‡ä»¶ â†’ æ‰“å¼€ â†’ é€‰æ‹© `/Users/sweety/TileSummoner`

3. **è¿è¡Œæµ‹è¯•**
   - æŒ‰ **F5** æˆ–ç‚¹å‡» "è¿è¡Œå½“å‰é¡¹ç›®"
   - ä¸»åœºæ™¯å·²è®¾ç½®ä¸º `test_tile_system.tscn`

4. **è§‚å¯Ÿè¾“å‡º**
   - æŽ§åˆ¶å°åº”æ˜¾ç¤ºæµ‹è¯•ç»“æžœ
   - å±å¹•ä¸Šåº”å‡ºçŽ°7Ã—9çš„åœ°å›¾
   - åœ°å—ä»Žä¸Šåˆ°ä¸‹é€è¡Œå‡ºçŽ°

---

## ðŸ“– æ ¸å¿ƒæ¦‚å¿µ

### åœ°å½¢ç±»åž‹ï¼ˆ9ç§ï¼‰

| åˆ†ç±» | åœ°å½¢ | ç±»åž‹ID | ç‰¹ç‚¹ |
|------|------|--------|------|
| åŸºç¡€ | è‰åœ° | `&"grassland"` | æ— åŠ æˆï¼ŒåŸºå‡†åœ°å½¢ |
| åŸºç¡€ | æ°´åŸŸ | `&"water"` | éžæ°´ç§»åŠ¨åŠ›-1ï¼Œæººæ°´5%/ç§’ |
| åŸºç¡€ | æ²™åœ° | `&"sand"` | éžåœ°ç§»åŠ¨åŠ›-1ï¼Œåœ°+1ï¼Œè§†é‡Ž+1 |
| è¿›é˜¶ | å²©çŸ³ | `&"rock"` | é˜²å¾¡+50%ï¼Œæ¶ˆè€—åŽä¿ç•™ |
| è¿›é˜¶ | æ£®æž— | `&"forest"` | è‰é˜²å¾¡+20%ï¼Œ20%é—ªé¿ |
| ç‰¹æ®Š | å†œç”° | `&"farmland"` | æ¯5ç§’æ¢å¤5%ï¼Œé˜²å¾¡-10% |
| ç‰¹æ®Š | ç†”å²© | `&"lava"` | éžç«ç¼çƒ§10%/ç§’ï¼Œç«æ”»å‡»+20% |
| ç‰¹æ®Š | æ²¼æ³½ | `&"swamp"` | éžæ°´ç§»åŠ¨åŠ›-1ï¼Œå›°ä½15% |
| ç‰¹æ®Š | å†°åŽŸ | `&"ice"` | éžå†°ç§»åŠ¨åŠ›-1ï¼Œå†»ç»“10% |

### ç½‘æ ¼åæ ‡ç³»ç»Ÿ

```
    0   1   2   3   4   5   6
  +---+---+---+---+---+---+---+
0 |æ•Œ |   |   | æ–¹ |   |   |   |
  +---+---+---+---+---+---+---+
1 |   |   |   |   |   |   |   |
  +---+---+---+---+---+---+---+
2 |   |   |   |   |   |   |   |
  +---+---+---+---+---+---+---+
3 |   |   |   |   |   |   |   |  â† æ•Œæ–¹åŒºåŸŸï¼ˆ5è¡Œï¼‰
  +---+---+---+---+---+---+---+
4 |   |   |   |   |   |   |   |
  +---+---+---+---+---+---+---+
5 |   |   |   |   |   |   |   |  â† æˆ‘æ–¹åŒºåŸŸï¼ˆ4è¡Œï¼‰
  +---+---+---+---+---+---+---+
6 |   |   |   |   |   |   |   |
  +---+---+---+---+---+---+---+
7 |   |   |   |   |   |   |   |
  +---+---+---+---+---+---+---+
8 |æˆ‘ |   |   | æ–¹ |   |   |   |
  +---+---+---+---+---+---+---+
```

**åæ ‡æ ¼å¼**: `Vector2i(x, y)` å…¶ä¸­ xâˆˆ[0,6], yâˆˆ[0,8]

---

## ðŸ’» ä»£ç ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šèŽ·å–åœ°å½¢æ•°æ®

```gdscript
# èŽ·å–è‰åœ°æ•°æ®
var grass_data: TileData = TileDatabase.get_tile_data(&"grassland")

# æ£€æŸ¥æ˜¯å¦æœ‰æ•ˆ
if grass_data:
    print("åœ°å½¢åç§°: %s" % grass_data.display_name)
    print("ç§»åŠ¨ä¿®æ­£: %d" % grass_data.movement_modifier)
```

### ç¤ºä¾‹2ï¼šåˆ›å»ºåœ°å—å®žä¾‹

```gdscript
# åˆ›å»ºåœ°å—åœºæ™¯
var tile_scene = preload("res://Scenes/tile/tile.tscn")
var tile = tile_scene.instantiate() as Tile

# è®¾ç½®æ•°æ®
tile.set_data(grass_data)

# æ·»åŠ åˆ°åœºæ™¯æ ‘
add_child(tile)
```

### ç¤ºä¾‹3ï¼šç”Ÿæˆæˆ˜æ–—åœ°å›¾

```gdscript
# èŽ·å–GridManagerå’ŒBattleMapGenerator
@onready var grid_manager: GridManager = $BattleMap/Tiles/GridManager
@onready var map_generator: BattleMapGenerator = $BattleMapGenerator

# ç”Ÿæˆåœ°å›¾ï¼ˆç®€å•éš¾åº¦ï¼‰
map_generator.initialize_battle_map(
    grid_manager,
    &"player_default",   # çŽ©å®¶é…ç½®
    &"enemy_easy"        # æ•Œæ–¹é…ç½®
)
```

### ç¤ºä¾‹4ï¼šæ›¿æ¢åœ°å—

```gdscript
# æ›¿æ¢åæ ‡(3, 5)çš„åœ°å—ä¸ºæ°´åŸŸ
var cell := Vector2i(3, 5)
grid_manager.replace_tile(cell, &"water")
```

### ç¤ºä¾‹5ï¼šç›‘å¬åœ°å—å˜åŒ–

```gdscript
func _ready() -> void:
    # æ³¨å†Œç›‘å¬å™¨
    MessageServer.register_listener(self, _on_tile_changed)

func _on_tile_changed(msg: TileChangedMessage) -> void:
    print("åœ°å— %s ä»Ž %s å˜ä¸º %s" % [
        msg.cell,
        msg.old_type,
        msg.new_type
    ])
```

### ç¤ºä¾‹6ï¼šä½¿ç”¨åº“å­˜ç³»ç»Ÿ

```gdscript
var inventory := TileInventory.new()

# åˆå§‹åŒ–é»˜è®¤åº“å­˜
inventory.initialize_default_inventory()

# èŽ·å–è‰åœ°æ•°é‡
var count := inventory.get_count(&"grassland")
print("è‰åœ°æ•°é‡: %d" % count)  # è¾“å‡º: 20

# æ¶ˆè€—ä¸€ä¸ªæ°´åŸŸ
var success := inventory.consume_tile(&"water")
if success:
    print("æ¶ˆè€—æ°´åŸŸæˆåŠŸ")
else:
    print("åº“å­˜ä¸è¶³")
```

---

## ðŸ”§ å¸¸ç”¨æ“ä½œ

### æŸ¥è¯¢æ‰€æœ‰åœ°å½¢ç±»åž‹

```gdscript
var all_types := TileDatabase.get_all_tile_types()
for type in all_types:
    var data := TileDatabase.get_tile_data(type)
    print("%s: %s" % [type, data.display_name])
```

### æ£€æŸ¥åæ ‡æ˜¯å¦æœ‰æ•ˆ

```gdscript
func is_valid_cell(cell: Vector2i) -> bool:
    return cell.x >= 0 and cell.x < 7 and cell.y >= 0 and cell.y < 9
```

### èŽ·å–ç‰¹å®šåœ°å—

```gdscript
# èŽ·å–(0, 0)çš„åœ°å—
var tile := grid_manager.get_tile(Vector2i(0, 0))

if tile:
    print("åœ°å—ç±»åž‹: %s" % tile._data.tile_type)
    print("åœ°å—ä½ç½®: %s" % tile.position)
```

### æ’­æ”¾åˆ‡æ¢åŠ¨ç”»

```gdscript
var tile := grid_manager.get_tile(Vector2i(3, 5))
if tile:
    tile.play_switch_animation()
```

---

## ðŸ“ æ–‡ä»¶ç»“æž„

```
TileSummoner/
â”œâ”€â”€ Resources/
â”‚   â””â”€â”€ Tiles/                        # åœ°å½¢æ•°æ®
â”‚       â”œâ”€â”€ grassland.tres            # 9ç§åœ°å½¢
â”‚       â”œâ”€â”€ water.tres
â”‚       â”œâ”€â”€ ...
â”‚   â””â”€â”€ Configs/                      # é…ç½®æ–‡ä»¶
â”‚       â”œâ”€â”€ player_default.tres       # çŽ©å®¶é…ç½®
â”‚       â”œâ”€â”€ enemy_easy.tres           # æ•Œæ–¹é…ç½®
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ Scripts/
â”‚   â”œâ”€â”€ tile/                         # åœ°å—ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ tile_data.gd              # åœ°å½¢æ•°æ®ç±»
â”‚   â”‚   â”œâ”€â”€ tile_config.gd            # é…ç½®èµ„æºç±»
â”‚   â”‚   â”œâ”€â”€ tile_database.gd          # åœ°å½¢æ•°æ®åº“
â”‚   â”‚   â”œâ”€â”€ tile.gd                   # åœ°å—è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ grid_manager.gd           # ç½‘æ ¼ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ battle_map_generator.gd   # åœ°å›¾ç”Ÿæˆå™¨
â”‚   â”‚
â”‚   â””â”€â”€ inventory/                    # åº“å­˜ç³»ç»Ÿ
â”‚       â””â”€â”€ tile_inventory.gd         # åº“å­˜ç®¡ç†å™¨
â”‚
â””â”€â”€ Scenes/
    â”œâ”€â”€ tile/                         # åœ°å—åœºæ™¯
    â”‚   â””â”€â”€ tile.tscn
    â”œâ”€â”€ battle_map.tscn               # æˆ˜æ–—åœ°å›¾
    â””â”€â”€ test_tile_system.tscn         # æµ‹è¯•åœºæ™¯
```

---

## ðŸŽ¯ ä¸‹ä¸€æ­¥

### ç«‹å³å¯åš
1. âœ… è¿è¡Œæµ‹è¯•åœºæ™¯ï¼ŒéªŒè¯ç³»ç»Ÿæ­£å¸¸
2. âœ… ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè°ƒæ•´åœ°å½¢å¸ƒå±€
3. âœ… å°è¯•æ›¿æ¢åœ°å—ï¼Œè§‚å¯ŸåŠ¨ç”»æ•ˆæžœ

### å¾…å®žçŽ°åŠŸèƒ½
4. â³ åˆ›å»ºåœ°å—ç¼–è¾‘å™¨UI
5. â³ å®žçŽ°å•ä½å¬å”¤ç³»ç»Ÿ
6. â³ æ·»åŠ è¿žé€šæ€§æ£€æµ‹
7. â³ å®žçŽ°æˆ˜æ–—é€»è¾‘

---

## ðŸ› å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆåœ°å—è´´å›¾æ²¡æœ‰æ˜¾ç¤ºï¼Ÿ
**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. è´´å›¾æ–‡ä»¶æ˜¯å¦å­˜åœ¨äºŽ `Assets/Sprites/Tiles/`
2. TileDatabase æ˜¯å¦æ­£ç¡®åŠ è½½
3. æŸ¥çœ‹æŽ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯

### Q: å¦‚ä½•æ·»åŠ æ–°åœ°å½¢ï¼Ÿ
**A**: æŒ‰ä»¥ä¸‹æ­¥éª¤ï¼š
1. åœ¨ `Resources/Tiles/` åˆ›å»ºæ–°çš„ `.tres` æ–‡ä»¶
2. åœ¨ `tile_database.gd` çš„ `_load_all_tiles()` ä¸­æ·»åŠ åœ°å½¢ç±»åž‹
3. åœ¨ `texture_names` å­—å…¸ä¸­æ·»åŠ è´´å›¾æ˜ å°„
4. è¿è¡Œæµ‹è¯•éªŒè¯

### Q: å¦‚ä½•ä¿®æ”¹ç½‘æ ¼å°ºå¯¸ï¼Ÿ
**A**: ä¿®æ”¹ `grid_manager.gd` ä¸­çš„å¸¸é‡ï¼š
```gdscript
const GRID_WIDTH: int = 7   # ä¿®æ”¹åˆ—æ•°
const GRID_HEIGHT: int = 9  # ä¿®æ”¹è¡Œæ•°
```

### Q: æ¶ˆæ¯ç³»ç»Ÿå¦‚ä½•ä½¿ç”¨ï¼Ÿ
**A**: å‚è€ƒä»¥ä¸‹æ­¥éª¤ï¼š
1. å‘é€æ¶ˆæ¯ï¼š`MessageServer.send_message(msg)`
2. æ³¨å†Œç›‘å¬ï¼š`MessageServer.register_listener(self, callback)`
3. å–æ¶ˆç›‘å¬ï¼š`MessageServer.unregister_listener(self)`

---

## ðŸ“š ç›¸å…³æ–‡æ¡£

- `Docs/åœ°å—ç³»ç»Ÿå®žçŽ°æ€»ç»“.md` - å®Œæ•´å®žçŽ°æ€»ç»“
- `Docs/CODING_STANDARDS.md` - ç¼–ç æ ‡å‡†
- `Docs/game_design/06_åœ°å½¢ç³»ç»Ÿ_å®Œæ•´.md` - åœ°å½¢ç³»ç»Ÿè®¾è®¡

---

**ç¥å¼€å‘é¡ºåˆ©ï¼** ðŸŽ‰
